{
  "codeName" : "recommend_department",
  "defaultParamName" : "Default",
  "dynaModelFilePath" : "PSMODULES/hr/PSDATAENTITIES/hr_candidate_filter/PSDELOGICS/recommend_department.json",
  "logicName" : "推荐给用人部门",
  "name" : "推荐给用人部门",
  "getPSDELogicNodes" : [ {
    "codeName" : "Begin",
    "leftPos" : 360,
    "logicNodeType" : "BEGIN",
    "name" : "开始",
    "getPSDELogicLinks" : [ {
      "getDstPSDELogicNode" : {
        "modelref" : true,
        "id" : "RAWSFCODE1"
      },
      "name" : "连接名称",
      "getSrcPSDELogicNode" : {
        "modelref" : true,
        "id" : "Begin"
      }
    } ],
    "topPos" : 150,
    "parallelOutput" : true
  }, {
    "code" : " // 获取默认参数\r\n    def _default = logic.param('Default').getReal()\r\n\r\n    String reviewerUserIds = _default.get('reviewer_user_ids')\r\n\r\n// 解析JSON并提取id列表\r\n    def jsonSlurper = new groovy.json.JsonSlurper()\r\n    def list = jsonSlurper.parseText(reviewerUserIds)\r\n    def ids = list.collect { it.id } // 提取所有id\r\n\r\n    String applicant_id = _default.get('applicant_id')\r\n    String type = _default.get('type')\r\n    String memo = _default.get('memo')\r\n\r\n    def id = _default.get(\"id\")\r\n// 创建主表实体\r\n    def hrCandidateFilterRuntime = sys.dataentity('hr_candidate_filter')\r\n    def hrCandidateFilterEntity = hrCandidateFilterRuntime.createEntity()\r\n    hrCandidateFilterEntity.set(\"applicant_id\", applicant_id)\r\n    hrCandidateFilterEntity.set(\"type\", type)\r\n    hrCandidateFilterEntity.set(\"reviewer_user_ids\", reviewerUserIds)\r\n    hrCandidateFilterEntity.set(\"id\", id)\r\n    hrCandidateFilterEntity.set(\"memo\", memo)\r\n    hrCandidateFilterRuntime.save(hrCandidateFilterEntity)\r\n\r\n// 创建明细表实体\r\n    def hrCandidateFilterDetailRuntime = sys.dataentity('hr_candidate_filter_detail')\r\n    String candidateFilterId = hrCandidateFilterEntity.get(\"id\")\r\n\r\n    ids.each { userid ->\r\n        def hrDetailFilter = hrCandidateFilterDetailRuntime.filter()\r\n        hrDetailFilter.eq(\"candidate_filter_id\", candidateFilterId)\r\n        hrDetailFilter.eq(\"user_id\", userid)\r\n        hrDetailFilter.eq(\"applicant_id\", applicant_id)\r\n        def hrCandidateFilterDetailList = hrCandidateFilterDetailRuntime.select(hrDetailFilter)\r\n        if (hrCandidateFilterDetailList.size() > 0) {\r\n            return\r\n        }\r\n\r\n        def hrCandidateFilterDetailEntity = hrCandidateFilterDetailRuntime.createEntity()\r\n        hrCandidateFilterDetailEntity.set(\"candidate_filter_id\", candidateFilterId)\r\n        hrCandidateFilterDetailEntity.set(\"memo\", memo)\r\n        hrCandidateFilterDetailEntity.set(\"user_id\", userid)\r\n        hrCandidateFilterDetailEntity.set(\"applicant_id\", applicant_id)\r\n        hrCandidateFilterDetailRuntime.save(hrCandidateFilterDetailEntity)\r\n    }",
    "codeName" : "RAWSFCODE1",
    "codeType" : "Groovy",
    "leftPos" : 320,
    "logicNodeType" : "RAWSFCODE",
    "name" : "执行脚本代码",
    "getPSDELogicLinks" : [ {
      "getDstPSDELogicNode" : {
        "modelref" : true,
        "id" : "END1"
      },
      "name" : "连接名称",
      "getSrcPSDELogicNode" : {
        "modelref" : true,
        "id" : "RAWSFCODE1"
      }
    } ],
    "topPos" : 287
  }, {
    "codeName" : "END1",
    "leftPos" : 360,
    "logicNodeType" : "END",
    "name" : "结束",
    "topPos" : 419
  } ],
  "getPSDELogicParams" : [ {
    "codeName" : "Default",
    "logicName" : "传入变量",
    "name" : "传入变量",
    "getParamPSDataEntity" : {
      "modelref" : true,
      "path" : "PSMODULES/hr/PSDATAENTITIES/hr_candidate_filter.json"
    },
    "default" : true,
    "entityParam" : true
  } ],
  "getStartPSDELogicNode" : {
    "modelref" : true,
    "id" : "Begin"
  },
  "enableBackend" : true,
  "enableFront" : false
}